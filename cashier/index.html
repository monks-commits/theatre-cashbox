<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ö–∞—Å–∞ —Ç–µ–∞—Ç—Ä—É ‚Äî –≤–∏–±—ñ—Ä –≤–∏—Å—Ç–∞–≤–∏</title>

  <link rel="stylesheet" href="../styles.css" />

  <style>
    body{
      background:#f3f4f6;
    }
    .wrap{
      max-width:720px;
      margin:40px auto;
      background:#fff;
      border:1px solid #e5e7eb;
      border-radius:16px;
      padding:20px;
      box-shadow:0 10px 25px rgba(15,23,42,.08);
    }
    h1{
      margin-top:0;
    }
    select{
      width:100%;
      padding:12px;
      border-radius:12px;
      border:1px solid #e5e7eb;
      font-size:16px;
    }
    .btn{
      margin-top:16px;
      padding:12px 16px;
      border-radius:999px;
      border:0;
      cursor:pointer;
      font-weight:800;
      font-size:15px;
    }
    .btn-primary{
      background:#2563eb;
      color:#fff;
    }
    .muted{
      color:#6b7280;
      font-size:14px;
      margin-top:8px;
    }
  </style>
</head>
<body>

  <div class="wrap">
    <h1>üéü –ö–∞—Å–∞ —Ç–µ–∞—Ç—Ä—É</h1>

    <p class="muted">
      –û–±–µ—Ä—ñ—Ç—å –≤–∏—Å—Ç–∞–≤—É –¥–ª—è –ø—Ä–æ–¥–∞–∂—É –∫–≤–∏—Ç–∫—ñ–≤ —É –∫–∞—Å—ñ
    </p>

    <select id="showSelect">
      <option value="">‚Äî –æ–±–µ—Ä—ñ—Ç—å –≤–∏—Å—Ç–∞–≤—É ‚Äî</option>
    </select>

    <button class="btn btn-primary" id="openHall">
      –í—ñ–¥–∫—Ä–∏—Ç–∏ —Å—Ö–µ–º—É –∑–∞–ª—É
    </button>

    <p class="muted" id="hint"></p>
  </div>

  <script>
    const select = document.getElementById("showSelect");
    const btn = document.getElementById("openHall");
    const hint = document.getElementById("hint");

    async function loadShows(){
      try{
        const res = await fetch("../data/shows.json", { cache:"no-store" });
        if (!res.ok) throw new Error("–ù–µ –º–æ–∂—É –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ shows.json");

        const shows = await res.json();
        if (!Array.isArray(shows) || !shows.length){
          hint.textContent = "‚ùå –ù–µ–º–∞—î –≤–∏—Å—Ç–∞–≤ —É data/shows.json";
          return;
        }

        shows.forEach(s=>{
          const opt = document.createElement("option");
          opt.value = s.id;
          opt.textContent = `${s.title} ‚Ä¢ ${s.date} ${s.time}`;
          select.appendChild(opt);
        });

      }catch(e){
        console.error(e);
        hint.textContent = "‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –≤–∏—Å—Ç–∞–≤";
      }
    }

    btn.addEventListener("click", ()=>{
      const showId = select.value;
      if (!showId){
        alert("–û–±–µ—Ä—ñ—Ç—å –≤–∏—Å—Ç–∞–≤—É");
        return;
      }

      // –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –≤ –∞–≤—Ç–æ–Ω–æ–º–Ω—É —Å—Ö–µ–º—É –∑–∞–ª—É
      location.href = `../hall/hall.html?show=${encodeURIComponent(showId)}&role=cashier`;
    });

    loadShows();
  </script>
</body>
</html>
